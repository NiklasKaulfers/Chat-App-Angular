<div class="container mt-4">
  <div class="row justify-content-center">
    <div class="col-lg-10">
      <div class="card shadow">
        <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
          <h5 class="mb-0">Chat Room: {{room || 'Lobby'}}</h5>
          <div>
            <span class="badge bg-light text-dark me-2">{{user || 'Guest'}}</span>
            <button class="btn btn-sm btn-outline-light" title="Settings">
              <i class="bi bi-gear"></i>
            </button>
          </div>
        </div>
        <div class="card-body chat-container p-0">
          <div class="chat-box p-3" #chatBox>
            <div *ngFor="let msg of messages"
                 class="chat-message mb-2 p-2 rounded"
                 [ngClass]="{'sender-message': msg.sender === user, 'received-message': msg.sender !== user, 'system-message': msg.sender === 'Server'}">
              <div class="message-header mb-1">
                <strong>{{ msg.sender }}</strong>
                <small *ngIf="msg.timestamp" class="text-muted ms-2">{{ msg.timestamp | date:'shortTime' }}</small>
              </div>
              <div class="message-content">{{ msg.message }}</div>
            </div>
          </div>
          <div class="typing-indicator px-3 py-1 text-muted" *ngIf="someoneTyping">
            <small>Someone is typing...</small>
          </div>
          <div class="input-area p-3 border-top">
            <div class="d-flex">
              <button class="btn btn-outline-secondary me-2" title="Attach file">
                <i class="bi bi-paperclip"></i>
              </button>
              <input type="text"
                     class="form-control me-2"
                     placeholder="Type a message..."
                     [(ngModel)]="userInput"
                     (keyup)="onTyping(true)"
                     (keyup.enter)="sendMessage()"
                     (blur)="onTyping(false)">
              <button class="btn btn-primary" (click)="sendMessage()">
                <i class="bi bi-send-fill"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
