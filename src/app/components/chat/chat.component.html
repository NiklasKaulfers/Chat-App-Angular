<div class="container-fluid p-3 h-80">
  <div class="row h-100">
    <div class="col-12 h-80">
      <div class="card shadow h-80">
        <div class="card-header bg-dark text-white d-flex justify-content-between align-items-center">
          <h5 class="mb-0">Chat Room: {{room || 'Lobby'}}</h5>
          <div>
            <span class="badge bg-light text-dark me-2">{{user || 'Guest'}}</span>
            <button class="btn btn-sm btn-outline-light" title="Settings">
              <i class="bi bi-gear"></i>
            </button>
          </div>
        </div>

        <div class="card-body d-flex flex-column p-0 h-80">
          <div class="chat-box flex-grow-1 p-3 overflow-auto" #chatBox>
            <div *ngFor="let msg of messages"
                 class="chat-message mb-2 p-2 rounded"
                 [ngClass]="{'sender-message': msg.sender === user, 'received-message': msg.sender !== user, 'system-message': msg.sender === 'Server'}">
              <div class="message-header mb-1">
                <strong>{{ msg.sender }}</strong>
                <small *ngIf="msg.timestamp" class="text-muted ms-2">{{ msg.timestamp | date:'shortTime' }}</small>
              </div>
              <div class="message-content">{{ msg.message }}</div>
            </div>
          </div>

          <div class="p-2 ms-3" *ngIf="someoneTyping">
            <small class="text-muted fst-italic">Someone is typing...</small>
          </div>

          <div class="chat-input p-2 border-top mt-auto">
            <div class="input-group">
              <input type="text"
                     class="form-control"
                     placeholder="Type a message..."
                     [(ngModel)]="userInput"
                     (keyup)="onTyping(true)"
                     (keyup.enter)="sendMessage()"
                     (blur)="onTyping(false)">
              <button class="btn btn-primary" (click)="sendMessage()">
                <i class="bi bi-send-fill"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
