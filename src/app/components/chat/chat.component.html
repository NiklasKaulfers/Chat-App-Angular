<div class="container-fluid chat-container">
  <div class="row h-100">
    <div class="col-md-9 col-12 p-0 d-flex flex-column">
      <div class="card shadow h-90">
        <div class="card-header bg-dark text-white d-flex justify-content-between align-items-center">
          <h5 class="mb-0">Chat Room: {{room || 'Lobby'}}</h5>
        </div>

        <div class="card-body d-flex flex-column p-0 h-100 col-12">
          <div class="chat-messages p-3 " #chatBox>
            <div *ngFor="let msg of messages"
                 class="message mb-3"
                 [ngClass]="{'align-self-start': msg.sender !== user, 'align-self-end': msg.sender === user}">
              <div [ngClass]="{'bg-light rounded p-2': msg.sender !== user, 'bg-primary text-black rounded p-2': msg.sender === user, 'bg-secondary text-black rounded p-2': msg.sender === 'Server'}">
                <strong>{{ msg.sender }}:</strong> {{ msg.message }}
                <small *ngIf="msg.timestamp" class="text-muted ms-2">{{ msg.timestamp | date:'shortTime' }}</small>
              </div>
            </div>
          </div>

          <div class="p-2 ms-3" *ngIf="someoneTyping">
            <small class="text-muted fst-italic">Someone is typing...</small>
          </div>

          <div class="message-input p-3 border-top mt-auto">
            <div class="input-group">
              <input type="text"
                     class="form-control"
                     placeholder="Type a message..."
                     [(ngModel)]="userInput"
                     (keyup)="onTyping(true)"
                     (keyup.enter)="sendMessage()"
                     (blur)="onTyping(false)">
              <button class="btn btn-primary" (click)="sendMessage()">
                <i class="bi bi-send-fill"></i> Send
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
